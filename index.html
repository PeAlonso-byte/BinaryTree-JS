<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <title>Binary Search Tree</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
      integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z"
      crossorigin="anonymous"
    />
    <style>
      .node circle {
        fill: #fff;
        stroke: gray;
        stroke-width: 3px;
      }
      .textId {
        cursor: default;
      }
      .node text {
        font: 12px sans-serif;
      }
      #blocks_container {
        text-align: center;
      }
      #block1,
      #block2 {
        display: inline;
      }

      #block1 {
        margin-top: 10px;
      }

      .link {
        fill: none;
        stroke: black;
        stroke-width: 5px;
      }

      .hidden {
        stroke: rgba(0, 0, 0, 0.1);
      }
      .nhidden {
        fill: rgb(255, 255, 255) !important;
        stroke: rgb(255, 255, 255);
      }
      .lhidden {
        fill: rgb(255, 255, 255) !important;
        stroke: rgb(255, 255, 255) !important;
        stroke-width: 0px;
      }
      .ce {
        fill: rgb(255, 255, 255) !important;
        stroke: rgb(255, 255, 255) !important;
        stroke-width: 0px;
      }
      #buttonPostorder {
        margin-top: 10px;
      }
    </style>
    <script src="binaryTreeImplementation.js"></script>
  </head>

  <body>
    <div id="blocks_container" class="container">
      <div class="row">
        <div id="block1" class="col-sm">
          <button class="btn btn-outline-info btn-lg" id="buttonInorder">
            Inorder
          </button>
          <button class="btn btn-outline-info btn-lg" id="buttonPostorder">
            Postorder
          </button>
        </div>
        <div id="block2" class="col-sm container_svg"></div>
      </div>
    </div>
    <!-- load the d3.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js"></script>

    <script>

      /* SET VARIABLES THAT WE GONNA NEED */

      var BST = new BinarySearchTree(); // INSTANCE OF BST CLASS
      var numeros = [15, 25, 10, 7, 22, 23, 13, 5, 9, 27]; // FIXED ARRAY
      var random = []; // RANDOM ARRAY

      // Inserting nodes to the BinarySearchTree
      randomBST(random); // FILLING THE ARRAY WITH RANDOM NUMBERS
      createBST(numeros, BST); // CREATING THE BST
  
      /* LET'S DRAW THE BINARY SEARCH TREE WITH D3.js */
      var dataNodes = []; // LET'S GIVE FORMAT TO OUR DATA
      var rootNode = BST.getRootNode(); // WE GET THE ROOT NODE OF OUR TREE

      var id = rootNode.data;
      var parentId = null;

      dataNodes.push({ id, parentId }); // WE NEED TO ADD MANUALLY THE ROOT ELEMENT
      transformData(rootNode, dataNodes);

      /* ------------------------ PARSING THE DATA --------------------------------------------------- */
      const idMapping = dataNodes.reduce((acc, el, i) => {
        acc[el.id] = i;
        return acc;
      }, {});

      let root;
      dataNodes.forEach((el) => {
        // Handle the root element
        if (el.parentId === null) {
          root = el;
          return;
        }
        // Use our mapping to locate the parent element in our dataNodes array
        const parentEl = dataNodes[idMapping[el.parentId]];
        // Add our current el to its parent's `children` array
        parentEl.children = [...(parentEl.children || []), el];
      });
      /* ------------------------------------------------------------------------------------------- */

      
      // ************** Generate the tree diagram	 *****************
      const DIV_CLASS = ".container_svg"; 
      drawBST(DIV_CLASS);

      /* ADD EVENT LISTENERS */
      document
        .getElementById("buttonInorder")
        .addEventListener("click", function () {
          var root = BST.getRootNode();
          getBackToNormal(root);
          inOrderAnimation(root);
        });
    
    </script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
      integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
      integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
